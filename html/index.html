
<!DOCTYPE html>
<html>
  <style>
    body { font-size: 100px; }
    @media only screen and (max-width: 600px) {
        body { font-size: 32px; }            
    }
  </style>
  
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>NUC</title>
    </style>
  </head>
<body>
  <script src="js/lclog.js" charset="utf-8"></script>    
  <script type="module" src='js/contenu.js'>    </script>
  <script src="https://cdn.jsdelivr.net/npm/onnxjs/dist/onnx.min.js"></script>
  <script src="js/common/ndarray-browser-min.js"></script>
  <script src="js/common/image-loader.js"></script>
  <link rel="stylesheet" type="text/css" href="aimaraJS/css/Aimara.css">
  <link rel="stylesheet" type="text/css" href="aimaraJS/css/Example.css">
  <script src="aimaraJS/lib/Aimara.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" integrity="sha512-E8QSvWZ0eCLGk4km3hxSsNmGWbLtSCSUcewDQPQWZF6pEU8GlT8a5fF32wOl1i8ftdMhssTrF/OhyGWwonTcXA==" crossorigin="anonymous" referrerpolicy="no-referrer">
  </script>
  
  <script>

    function allowDrop(ev) {
        ev.preventDefault();
    }
    
    function drag(ev) {
        ev.dataTransfer.setData("text", ev.target.id);
    }
    
    function drop(ev) {
        ev.preventDefault();
        var data = ev.dataTransfer.getData("text");
        ev.target.appendChild(document.getElementById(data));
    }

     
    
  </script>
  
    <p>
      <ul>
        <li>  <a href="https://MYIP:8093/sensor.html">Temp√©rature</a></li>
        <li>  <a href="http://MYIP:8080">Garage</a></li>
        <li>  <a href="http://MYIP:9000">Audio</a></li>
        <li>  <a href="linked.html">links</a></li>
        <li>  <a href="js-music-player/index.html">Audio player</a></li>
        <li>  <a href="running/running.html"> Running </a> </li>
        <li>  <a href="running/code.html"> Code </a> </li>
        <li>  <a href="ezviz/index"> EZViz </a> </li>
      </ul>
    </p>

    <div>
      <label for="key">KEY:</label>
      <textarea id="key" name="story" rows="5" cols="33">
      my secret key
      </textarea>
    </div>
    <div>
      <label for="story">Text:</label>
      <textarea id="textin" name="story" rows="5" cols="33">
        text
      </textarea>
      <button onclick="paste()">Paste</button>      
    </div>

    <button onclick="encrypt()">Encrypt</button>
    <button onclick="decrypt()">Decrypt</button>

    <div id="textout">  resultresultresultresultresult </div>
    

    <div id="div1" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    
    <img id="drag1" src="img_logo.gif" draggable="true" ondragstart="drag(event)" width="336" height="69">

    INFO
    
</body>

<script>
  //var CryptoJS = require( 'crypto-js' );
  
  var secretMessage = 'I hid the chips under the couch.';
  var secretKey = 'b52b4f45b6e9337b57869d7cb718c693';
  
  var encryptedMessage = CryptoJS.AES.encrypt(secretMessage, CryptoJS.enc.Hex.parse(secretKey),
                                              { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.NoPadding });
  
  console.log('encryptedMessage: ' + encryptedMessage.ciphertext);
  
  cipherParams = CryptoJS.lib.CipherParams.create(
      {ciphertext: CryptoJS.enc.Hex.parse(encryptedMessage.ciphertext.toString())});
  
  var bytes = CryptoJS.AES.decrypt(cipherParams,CryptoJS.enc.Hex.parse(secretKey),
                                   { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.NoPadding });
  
  console.log( 'Decrypted:' + bytes.toString(CryptoJS.enc.Utf8));
  
  key = document.getElementById("key");
  text_in = document.getElementById("textin");
  text_out = document.getElementById("textout");
  

  function encrypt(ev) {
      const keytxt  = key.value; //innerHTML;
      const secret = text_in.value; //innerHTML;
      console.log(keytxt);
      console.log(secret);
      const encrypted = CryptoJS.AES.encrypt(secret, CryptoJS.enc.Hex.parse(keytxt),
                                             { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.NoPadding });
      text_out.innerHTML = encrypted;

      /*
      const copyText = encrypted;
      copyText.select();
      copyText.setSelectionRange(0, 99999); // For mobile devices
      
      // Copy the text inside the text field
      navigator.clipboard.writeText(copyText.value);
      
      // Alert the copied text
      alert("Copied the text: " + copyText.value);
      */
  }

  function paste() {
      navigator.clipboard.readText().then(function(clipboardText) {
          text_in.innerHTML = clipboardText;
      }).catch(function(err) {
          console.log("paste failed");
      });
  }
  
  function decrypt(ev) {
      const keytxt  = key.value;
      const secret = text_in.value;

      cipherParams = CryptoJS.lib.CipherParams.create(
          {ciphertext: CryptoJS.enc.Hex.parse(secret)});
      
      const bytes = CryptoJS.AES.decrypt(cipherParams,CryptoJS.enc.Hex.parse(secret),
                                         { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.NoPadding });
      const mm = bytes.toString(CryptoJS.enc.Utf8);

      console.log(keytxt);
      console.log(secretMessage);
      text_out.innerHTML = mm;
      const copyText = mm;
      copyText.select();
      copyText.setSelectionRange(0, 99999); // For mobile devices
      
      // Copy the text inside the text field
      navigator.clipboard.writeText(copyText.value);
      
      // Alert the copied text
      alert("Copied the text: " + copyText.value);
  }
    
    
  
</script>

</html>
